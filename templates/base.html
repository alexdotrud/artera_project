{% load static %}

<!DOCTYPE html>
<html lang="en">

<head>
    {% block meta %}
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="Aleksandra Rudenko">
    <meta name="description"
        content="Artera is a full-stack e-commerce web application for discovering and purchasing unique artworks.">
    <meta name="keywords"
        content="artworks, prints, digital art, paintings, drawings, photography, sculptures, mixed media, art gallery, online art store">
    {% endblock %}

    {% block extra_meta %}{% endblock %}

    {% block corecss %}
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700&display=swap">
    {% endblock %}

    {% block extra_css %}{% endblock %}

    {% block links %}

    <!-- Link to Bootstrap/JS/Stripee -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://js.stripe.com/v3/"></script>

    <!--Link to Font Awesome-->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

    <!--Link to CSS -->
    <link rel="stylesheet" href="{% static 'css/base.css' %}">

    <!--Link to jQuery-->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!--Link to Google Fonts-->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cardo:ital,wght@0,400;0,700;1,400&display=swap"
        rel="stylesheet">

    <!-- Favicon -->
    <link rel="apple-touch-icon" sizes="180x180" href="{% static 'images/favicon_io/apple-touch-icon.png' %}">
    <link rel="icon" type="image/png" sizes="32x32" href="{% static 'images/favicon_io/favicon-32x32.png' %}">
    <link rel="icon" type="image/png" sizes="16x16" href="{% static 'images/favicon_io/favicon-16x16.png' %}">
    <link rel="shortcut icon" href="{% static 'images/favicon_io/favicon.ico' %}" type="image/x-icon">
    <link rel="manifest" href="{% static 'images/favicon_io/site.webmanifest' %}">
    {% endblock %}

    <title>ARTERA · {% block page_name %}{% endblock %}</title>

</head>

<body>
    <!-- Header -->
    <header class="fixed-top bg-white border-bottom">
        <nav class="navbar navbar-expand-md navbar-light bg-white">
            <div class="container-fluid position-relative px-4">
                <button class="navbar-toggler position-absolute start-0 d-md-none" type="button"
                    data-bs-toggle="collapse" data-bs-target="#mobileMenu" aria-controls="mobileMenu"
                    aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Logo (always centered) -->
                <a class="navbar-brand position-absolute top-50 start-50 translate-middle" href="{% url 'home' %}"
                    aria-label="Link to homepage">
                    <img src="{% static 'images/logo.png' %}" alt="Artera logo" style="height:34px;">
                </a>
                <!-- Mobile accounts Menu-->
                <div class="position-absolute end-0 top-50 translate-middle-y d-flex align-items-center d-md-none me-2">
                    <!-- Account -->
                    <div class="dropdown me-2">
                        <a class="nav-link text-dark" href="#" id="mobileAccount" data-bs-toggle="dropdown"
                            aria-expanded="false" aria-label="Dropdown for mobile screen">
                            <i class="fas fa-user fa-lg"></i>
                        </a>
                        <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="mobileAccount">
                            {% if request.user.is_authenticated %}
                            <li><a class="dropdown-item" href="{%url 'profile' %}" aria-label="Link to profile page">My
                                    Profile</a></li>
                            <li><a class="dropdown-item" href="{% url 'library' %}"
                                    aria-label="Link to library page">Library</a></li>
                            <li><a class="dropdown-item" href="{% url 'request' %}"
                                    aria-label="Link to request page">Make a Custom
                                    Request</a></li>
                            <li>
                                <hr class="dropdown-divider">
                            </li>
                            <li><a class="dropdown-item" href="{% url 'account_logout' %}"
                                    aria-label="Link to logout from website">Logout</a></li>
                            {% else %}
                            <li><a class="dropdown-item" href="{% url 'account_login' %}"
                                    aria-label="Link to login">Login</a></li>
                            <li><a class="dropdown-item" href="{% url 'account_signup' %}"
                                    aria-label="Link for registration">Register</a></li>
                            {% endif %}
                        </ul>
                    </div>
                    <!-- Cart -->
                    <a href="{% url 'view_bag' %}" class="mobile-cart-circle text-decoration-none">

                        {% if grand_total %}
                        {{ grand_total|floatformat:2 }}
                        {% else %}
                        0
                        {% endif %}
                    </a>
                </div>
                <!-- Desktop Menu -->
                <div class="collapse navbar-collapse d-none d-md-flex">
                    <!-- Left side menu -->
                    <ul class="navbar-nav me-auto align-items-center">
                        <li><a class="nav-link" href="{% url 'home' %}" aria-label="Link to homepage">Home</a></li>
                        <li><a class="nav-link" href="{% url 'all_artworks' %}" aria-label="Link to shop">Shop</a></li>
                        <li><a class="nav-link" href="{% url 'offer' %}"
                                aria-label="Link to collaboration page">Collaborate</a></li>
                    </ul>
                    <!-- Account and Bag -->
                    <ul class="navbar-nav ms-auto align-items-center">
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle d-flex align-items-center" href="#" id="accountMenu"
                                role="button" data-bs-toggle="dropdown" aria-expanded="false">
                                <i class="fas fa-user me-1"></i> Account
                            </a>
                            <ul class="dropdown-menu dropdown-menu-end border-0 shadow-sm"
                                aria-labelledby="accountMenu">
                                {% if request.user.is_authenticated %}
                                <li><a class="dropdown-item" href="{%url 'profile' %}"
                                        aria-label="Link to profile page">My
                                        Profile</a></li>
                                <li><a class="dropdown-item" href="{% url 'library' %}"
                                        aria-label="Link to library page">Library</a></li>
                                <li><a class="dropdown-item" href="{% url 'request' %}"
                                        aria-label="Link to request page">Make a Custom
                                        Request</a></li>
                                <li>
                                    <hr class="dropdown-divider">
                                </li>
                                <li><a class="dropdown-item" href="{% url 'account_logout' %}"
                                        aria-label="Link to logout from website">Logout</a></li>
                                {% else %}
                                <li><a class="dropdown-item" href="{% url 'account_login' %}"
                                        aria-label="Link to login">Login</a></li>
                                <li><a class="dropdown-item" href="{% url 'account_signup' %}"
                                        aria-label="Link for registration">Register</a></li>
                                {% endif %}
                            </ul>
                        </li>
                        <li class="nav-item ms-2">
                            <a class="nav-link position-relative" href="{% url 'view_bag' %}"
                                aria-label="link to reviw bag items">
                                <i class="fas fa-shopping-bag"></i> Bag
                                <span
                                    class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-dark">
                                    {% if grand_total %}
                                    ${{ grand_total|floatformat:2 }}
                                    {% else %}
                                    $0.00
                                    {% endif %}
                                </span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
        <!-- Mobile menu -->
        <div class="collapse bg-white border-top d-md-none" id="mobileMenu">
            <button class="btn btn-link text-dark w-100 text-end px-3 mt-2" type="button" data-bs-toggle="collapse"
                data-bs-target="#mobileMenu" aria-label="Close menu">
                ✕
            </button>
            <ul class="navbar-nav p-3">
                <li><a class="nav-link" href="{% url 'home' %}" aria-label="Link to homepage">Home</a></li>
                <li><a class="nav-link" href="{% url 'all_artworks' %}" aria-label="Link to shop">Shop</a></li>
                <li><a class="nav-link" href="{% url 'offer' %}" aria-label="Link to collaboration page">Collaborate</a>
                </li>
            </ul>
        </div>
    </header>

    <!-- Messages -->
    {% if messages %}
    <div id="toastSource" class="toast-container position-fixed top-0 end-0 p-3">
        {% for message in messages %}
        {% with message.level as level %}
        {% if level == 40 %}
        {% include 'includes/toasts/toast_error.html' %}
        {% elif level == 30 %}
        {% include 'includes/toasts/toast_warning.html' %}
        {% elif level == 25 %}
        {% include 'includes/toasts/toast_success.html' %}
        {% else %}
        {% include 'includes/toasts/toast_info.html' %}
        {% endif %}
        {% endwith %}
        {% endfor %}
    </div>
    {% endif %}

    <!-- Main content -->
    <main>
        {% block content %}
        {% endblock %}
    </main>

    <footer class="footer py-4">
        <p class="mb-1">
            © {% now "Y" %} Artera — All rights reserved.
        </p>
        <p class="small mb-0">
            Project made by <strong>Aleksandra Rudenko</strong>
        </p>
        <div class="footer-icons">
            <a href="https://www.linkedin.com/in/aleksandra-rudenko/" target="_blank"
                title="Check my profile on LinkedIn" aria-label="Link to my LinkedIn profile"><i
                    class="fa-brands fa-linkedin"></i></a>
            <a href="https://github.com/alexdotrud" target="_blank" title="Check my profile on Github"
                aria-label="Link to my GitHub profile"><i class="fa-brands fa-github"></i></a>
            <form method="post" action="{% url 'newsletter_subscribe' %}" class="mt-2 newsletter-form">
                {% csrf_token %}
                <input type="email" name="email" class="form-control form-control-sm"
                    placeholder="Sign up for art updates" required>
                <button type="submit" class="btn btn-dark btn-sm">
                    Subscribe
                </button>
            </form>

            <div class="footer-links mt-2">
                <p class="small">
                    <a href="#" data-bs-toggle="modal" data-bs-target="#termsModal">
                        Terms & Conditions
                    </a>
                    |
                    <a href="#" data-bs-toggle="modal" data-bs-target="#privacyModal">
                        Privacy Policy
                    </a>
                </p>
            </div>
    </footer>

    <div id="loading-overlay" style="display: none;">
        <div class="loading-spinner">
            <i class="fas fa-3x fa-sync-alt fa-spin"></i>
            <p>Processing your payment…</p>
        </div>
    </div>

    <!-- Terms and Conditions Modal -->
    <div class="modal fade" id="termsModal" tabindex="-1" aria-labelledby="termsModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-scrollable modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="termsModalLabel">Terms &amp; Conditions</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body text-start">
                    <h5 class="fw-semibold mb-2">• Digital products</h5>
                    <p>All artworks on Artera are <strong>digital downloads</strong>. No physical items are shipped.</p>

                    <h5 class="fw-semibold mb-2">• Access to files</h5>
                    <p>
                        After purchase, your files are available in your <strong>Library</strong> when you are logged
                        in.
                        You are responsible for keeping your account credentials secure.
                    </p>

                    <h5 class="fw-semibold mb-2">• Personal use only</h5>
                    <p>
                        Unless explicitly stated otherwise, artworks are licensed for personal, non-commercial use.
                        You may print them for yourself or as a gift, but you may not resell, redistribute, or use them
                        commercially.
                    </p>

                    <h5 class="fw-semibold mb-2">• Refunds</h5>
                    <p>
                        Because our products are digital and instantly available, all sales are generally final.
                        If you have a technical issue with a file, please contact us and we will do our best to help.
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Privacy Policy Modal -->
    <div class="modal fade" id="privacyModal" tabindex="-1" aria-labelledby="privacyModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-scrollable modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="privacyModalLabel">Privacy Policy</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body text-start">
                    <h5 class="fw-semibold mb-2">• What we collect</h5>
                    <p>
                        We collect your name, email address, account details, order history, and basic technical
                        information
                        (such as IP address and browser type) when you use Artera.
                    </p>

                    <h5 class="fw-semibold mb-2">• How we use your data</h5>
                    <p>
                        We use this information to manage your account and Library, process orders, send important
                        account and
                        order emails, and improve the site.
                    </p>

                    <h5 class="fw-semibold mb-2">• Third-party services</h5>
                    <p>
                        We may use trusted third-party services such as payment processors and email providers.
                        They only receive the data necessary to perform their function.
                    </p>

                    <h5 class="fw-semibold mb-2">• Your rights</h5>
                    <p>
                        You can request access, correction, or deletion of your personal data where applicable.
                        If you have questions about your data, please contact us via the email address provided on the
                        site.
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div class="modal fade" id="confirmDeleteModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content border-0 shadow-sm">
                <div class="modal-body">
                    Are you sure you want to delete?
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Cancel</button>

                    <form method="post" id="deleteConfirmForm">
                        {% csrf_token %}
                        <button type="submit" class="btn btn-danger">Yes, delete</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Show Toasts
            document.querySelectorAll('#toastSource .toast').forEach(el => {
                bootstrap.Toast.getOrCreateInstance(el).show();
            });
            // Delete Confirmation Modal
            const deleteModal = document.getElementById('confirmDeleteModal');

            if (deleteModal) {
                deleteModal.addEventListener('show.bs.modal', event => {
                    const button = event.relatedTarget;
                    const actionUrl = button.getAttribute('data-action-url');
                    const itemLabel = button.getAttribute('data-item-label') || "this item";

                    const form = deleteModal.querySelector('#deleteConfirmForm');
                    const labelSpan = deleteModal.querySelector('.item-label');

                    form.action = actionUrl;
                    labelSpan.textContent = itemLabel;
                });
            }

        });
    </script>

    {% block postloadjs %}{% endblock %}

</body>

</html>